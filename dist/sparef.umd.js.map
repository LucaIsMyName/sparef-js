{"version":3,"file":"sparef.umd.js","sources":["../src/prefetch.ts","../src/utils.ts","../src/transition.ts","../src/sparef.ts"],"sourcesContent":["import { PrefetchOptions } from './types';\n\nconst prefetchedLinks = new Set<string>();\n\nfunction isSameOrigin(href: string): boolean {\n  try {\n    const url = new URL(href, window.location.origin);\n    return url.origin === window.location.origin;\n  } catch {\n    return false;\n  }\n}\n\nexport function setupPrefetch(container: Element, options: PrefetchOptions): void {\n  console.log(\"Setting up prefetch with options:\", options);\n  if (!options.active) return;\n\n  const links = container.querySelectorAll('a[href^=\"/\"], a[href^=\"./\"], a[href^=\"../\"], a[href^=\"http://\"], a[href^=\"https://\"]');\n\n  links.forEach(link => {\n    link.addEventListener(options.event, () => {\n      setTimeout(() => {\n        const href = link.getAttribute('href');\n        if (href && !prefetchedLinks.has(href) && (options.sameOrigin === false || isSameOrigin(href))) {\n          const prefetchLink = document.createElement('link');\n          prefetchLink.rel = 'prefetch';\n          prefetchLink.href = href;\n          document.head.appendChild(prefetchLink);\n          prefetchedLinks.add(href);\n          console.log('Prefetched: ', href);\n        }\n      }, options.delay);\n    });\n  });\n}","// src/utils.ts\n\n/**\n * @description This function takes two objects, \n * options and defaults, and returns a new object \n * with the default values applied to the options object. \n * If a key exists in both objects, the value from \n * the options object is used. If the value is an object, \n * the function is called recursively to apply the defaults \n * to the nested object.\n */\nexport function applyDefaults<T extends Record<string, any>>(options: Partial<T>, defaults: T): T {\n  const result = { ...defaults };\n  for (const key in options) {\n    if (Object.prototype.hasOwnProperty.call(options, key)) {\n      const value = options[key];\n      if (typeof value === 'object' && value !== null && key in result) {\n        result[key] = applyDefaults(\n          value as Partial<T[Extract<keyof T, string>]>,\n          result[key] as T[Extract<keyof T, string>]\n        );\n      } else {\n        result[key] = value as T[Extract<keyof T, string>];\n      }\n    }\n  }\n  return result;\n}\n\n/**\n * @description This function converts a string to \n * kebab case by replacing all uppercase letters with a \n * hyphen followed by the lowercase version of the letter.\n */\nexport function kebabCase(str: string): string {\n  return str.replace(/[A-Z]/g, letter => `-${letter.toLowerCase()}`);\n}","// src/transition.ts\n\nimport { TransitionOptions, TransitionAnimation, TransitionStyles } from \"./types\";\nimport { kebabCase } from \"./utils\";\n\n/**\n * @description Set up\n * transition between pages.\n */\ndeclare global {\n  interface Document {\n    startViewTransition?: (callback: () => void) => {\n      finished: Promise<void>;\n      updateCallbackDone: Promise<void>;\n      ready: Promise<void>;\n    };\n  }\n}\n\nlet styleCounter = 0;\nclass MockAnimation implements Animation {\n  currentTime: number | null = 0;\n  effect: AnimationEffect | null = null;\n  id: string = \"\";\n  oncancel: ((this: Animation, ev: AnimationPlaybackEvent) => any) | null = null;\n  onfinish: ((this: Animation, ev: AnimationPlaybackEvent) => any) | null = null;\n  onremove: ((this: Animation, ev: Event) => any) | null = null;\n  pending: boolean = false;\n  playState: AnimationPlayState = \"idle\";\n  playbackRate: number = 1;\n  replaceState: AnimationReplaceState = \"active\";\n  startTime: number | null = 0;\n  timeline: AnimationTimeline | null = null;\n\n  // Implement finished and ready as getters\n  get finished(): Promise<Animation> {\n    return Promise.resolve(this);\n  }\n\n  get ready(): Promise<Animation> {\n    return Promise.resolve(this);\n  }\n\n  cancel(): void {}\n  commitStyles(): void {}\n  finish(): void {}\n  pause(): void {}\n  persist(): void {}\n  play(): void {}\n  reverse(): void {}\n  updatePlaybackRate(_playbackRate: number): void {}\n  addEventListener(_type: string, _listener: EventListenerOrEventListenerObject, _options?: boolean | AddEventListenerOptions): void {}\n  removeEventListener(_type: string, _listener: EventListenerOrEventListenerObject, _options?: boolean | EventListenerOptions): void {}\n  dispatchEvent(_event: Event): boolean {\n    return false;\n  }\n}\n/**\n * @description Set up\n * transition between pages.\n */\nexport function setupTransition(\n  container: Element,\n  options: TransitionOptions,\n  animateFunction: (element: Element, keyframes: Keyframe[], options: KeyframeAnimationOptions) => Animation = (element, keyframes, options) => {\n    if (typeof element.animate === \"function\") {\n      return element.animate(keyframes, options);\n    } else {\n      return new MockAnimation();\n    }\n  }\n): void {\n  console.log(\"Setting up transition with options:\", options);\n\n  const links = container.querySelectorAll('a[href^=\"/\"], a[href^=\"./\"], a[href^=\"../\"]');\n\n  links.forEach((link) => {\n    link.addEventListener(\"click\", (e) => {\n      e.preventDefault();\n      const href = link.getAttribute(\"href\");\n\n      if (href) {\n        navigateTo(href, container, options, animateFunction);\n      }\n    });\n  });\n   // Add popstate event listener for browser back/forward buttons\n   window.addEventListener(\"popstate\", (event) => {\n    if (event.state && event.state.href) {\n      navigateTo(event.state.href, container, options, animateFunction, false);\n    }\n  });\n}\n\nasync function navigateTo(href: string, container: Element, options: TransitionOptions, animateFunction: (element: Element, keyframes: Keyframe[], options: KeyframeAnimationOptions) => Animation, pushState: boolean = true): Promise<void> {\n  if (document.startViewTransition) {\n    await performViewTransition(href, container, options, animateFunction);\n  } else {\n    await performFallbackTransition(href, container, options, animateFunction);\n  }\n\n  if (pushState) {\n    history.pushState({ href }, \"\", href);\n  }\n}\n\n/**\n * @description Generate a CSS style\n * string from a  transition animation object.\n */\nexport function generateStyleString(animation: TransitionAnimation): { from: string; to: string } {\n  function styleObjectToString(obj: Record<string, any>): string {\n    return Object.entries(obj)\n      .map(([key, value]) => {\n        if (typeof value === \"object\") {\n          return `${kebabCase(key)}: ${styleObjectToString(value)};`;\n        }\n        return `${kebabCase(key)}: ${value};`;\n      })\n      .join(\" \");\n  }\n\n  return {\n    from: styleObjectToString(animation.from),\n    to: styleObjectToString(animation.to),\n  };\n}\n\n/**\n *\n * @description Add CSS styles\n * for a view transition animation.\n */\nfunction addViewTransitionCSS(container: Element, options: TransitionOptions): string {\n  const outStyles = generateStyleString(options.out);\n  const inStyles = generateStyleString(options.in);\n  const styleId = `sparef-style-${styleCounter++}`;\n\n  const css = `\n    ::view-transition-old(${container.tagName.toLowerCase()}),\n    ::view-transition-new(${container.tagName.toLowerCase()}) {\n      animation-duration: ${options.duration}ms;\n      animation-timing-function: ${options.easing};\n      animation-iteration-count: ${options.iterations};\n    }\n\n    ::view-transition-old(${container.tagName.toLowerCase()}) {\n      animation-name: sparef_fade-out-${styleId};\n    }\n\n    ::view-transition-new(${container.tagName.toLowerCase()}) {\n      animation-name: sparef_fade-in-${styleId};\n    }\n\n    @keyframes sparef_fade-out-${styleId} {\n      from { ${outStyles.from} }\n      to { ${outStyles.to} }\n    }\n\n    @keyframes sparef_fade-in-${styleId} {\n      from { ${inStyles.from} }\n      to { ${inStyles.to} }\n    }\n  `;\n\n  const style = document.createElement(\"style\");\n  style.id = styleId;\n  style.textContent = css;\n  document.head.appendChild(style);\n\n  return styleId;\n}\n\n/**\n *\n * @description Remove a style\n * tag from the DOM.\n */\nfunction removeStyle(styleId: string): void {\n  const style = document.getElementById(styleId);\n  if (style) {\n    style.remove();\n  }\n}\n\n/**\n *\n * @description Perform a custom\n * view transition animation.\n */\nasync function performViewTransition(href: string, container: Element, options: TransitionOptions, animateFunction: (element: Element, keyframes: Keyframe[], options: KeyframeAnimationOptions) => Animation): Promise<void> {\n  try {\n    const styleId = addViewTransitionCSS(container, options);\n    const transition = document.startViewTransition!(() => updateDOM(href, container, options, animateFunction));\n\n    await transition.finished;\n    removeStyle(styleId);\n    console.log(\"Custom Transition complete\", options);\n  } catch (error) {\n    console.error(\"View transition failed:\", error);\n    window.location.href = href;\n  }\n}\n\n/**\n *\n * @description Perform a fallback\n * transition animation.\n */\nasync function performFallbackTransition(href: string, container: Element, options: TransitionOptions, animateFunction: (element: Element, keyframes: Keyframe[], options: KeyframeAnimationOptions) => Animation): Promise<void> {\n  const styleId = addViewTransitionCSS(container, options);\n  try {\n    const duration = options.duration;\n    const outAnim = createKeyframeAnimation(options.out, `out-${styleId}`);\n    const inAnim = createKeyframeAnimation(options.in, `in-${styleId}`);\n    const animationOptions: KeyframeAnimationOptions = {\n      duration: options.timeline === \"sequential\" ? duration / 2 : duration,\n      easing: options.easing,\n      iterations: options.iterations === \"infinite\" ? Infinity : options.iterations,\n      fill: \"forwards\",\n    };\n    const outAnimation = animateFunction(container, outAnim.keyframes, animationOptions);\n\n    if (outAnimation.finished) {\n      await outAnimation.finished;\n    } else {\n      await new Promise((resolve) => setTimeout(resolve, animationOptions.duration as number));\n    }\n\n    await updateDOM(href, container, options, animateFunction);\n\n    const inAnimation = animateFunction(container, inAnim.keyframes, {\n      duration: options.timeline === \"sequential\" ? duration / 2 : duration,\n      easing: options.easing,\n      iterations: 1,\n      fill: \"forwards\",\n    });\n\n    if (inAnimation.finished) {\n      await inAnimation.finished;\n    } else {\n      await new Promise((resolve) => setTimeout(resolve, duration / 2));\n    }\n  } finally {\n    removeStyle(styleId);\n    console.log(\"Fallback Transition complete\");\n  }\n}\n\n/**\n * @description Update the DOM\n * with new content.\n */\nasync function updateDOM(href: string, container: Element, options: TransitionOptions, animateFunction: (element: Element, keyframes: Keyframe[], options: KeyframeAnimationOptions) => Animation): Promise<void> {\n  try {\n    const response = await fetch(href);\n    const html = await response.text();\n    const newDocument = new DOMParser().parseFromString(html, \"text/html\");\n\n    // Update the page title\n    document.title = newDocument.title;\n\n    // Update the specific container content\n    const newContent = newDocument.querySelector(container.tagName);\n    if (newContent) {\n      container.innerHTML = newContent.innerHTML;\n    }\n\n    // Re-attach event listeners to the new content\n    // Remove this line to prevent calling setupTransition again\n    // setupTransition(container, options, animateFunction);\n  } catch (error) {\n    console.error(\"Failed to update DOM:\", error);\n    window.location.href = href;\n  }\n}\n\n/**\n *\n * @description Create a keyframe animation\n * object from a transition animation object.\n */\nfunction createKeyframeAnimation(animOptions: TransitionAnimation, prefix: string): { keyframes: Keyframe[] } {\n  return {\n    keyframes: [\n      { [prefix]: \"0%\", ...animOptions.from },\n      { [prefix]: \"100%\", ...animOptions.to },\n    ],\n  };\n}\n","// src/sparef.ts\n\nimport { setupPrefetch } from \"./prefetch\";\nimport { setupTransition } from \"./transition\";\nimport { applyDefaults } from \"./utils\";\nimport { SparefOptions, PrefetchOptions, TransitionOptions } from \"./types\";\n\nconst defaultOptions: SparefOptions = {\n  prefetch: {\n    active: false,\n    event: \"mouseover\",\n    delay: 0,\n    sameOrigin: true,\n  },\n  transition: {\n    duration: 250,\n    delay: 0,\n    timeline: \"parallel\",\n    easing: \"ease-in-out\",\n    iterations: 1,\n    out: {\n      from: { opacity: 1 },\n      to: { opacity: 0 },\n    },\n    in: {\n      from: { opacity: 0 },\n      to: { opacity: 1 },\n    },\n  },\n};\n\n/**\n * \n * @description Set up SPA transitions and prefetching.\n */\nexport function sparef(selector: string | string[], options: Partial<SparefOptions> = {}): void {\n  const mergedOptions = applyDefaults(options, defaultOptions);\n  console.log(\"Merged options:\", mergedOptions); // Add this line\n\n  const selectors = Array.isArray(selector) ? selector : [selector];\n\n  selectors.forEach((sel) => {\n    const container = document.querySelector(sel);\n    if (!container) {\n      console.error(`No element found with selector: ${sel}`);\n      return;\n    }\n\n    console.log(\"Setting up prefetch with options:\", mergedOptions.prefetch); // Add this line\n    setupPrefetch(container, mergedOptions.prefetch);\n    setupTransition(container, mergedOptions.transition);\n  });\n}\n\nexport default sparef;"],"names":[],"mappings":"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"}